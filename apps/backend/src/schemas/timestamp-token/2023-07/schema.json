{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Timestamp Token",
  "description": "Defines structure for a Timestamp Token",
  "type": "object",
  "properties": {
    "@context": {
      "description": "Semantic context for the issued credential",
      "type": "array",
      "items": {
        "type": "string",
        "format": "uri"
      }
    },
    "id": {
      "description": "Unique identifier of the timestamp token. Serial number as defined in rfc3161.",
      "type": "string"
    },
    "type": {
      "description": "Full type chain, used to identify the credential base types",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "issuer": {
      "description": "DID which issued this credential",
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "verifiableId": {
          "description": "verifiable id or claimed information about the TSA. See TSA in RFC3161",
          "type": "object"
        }
      }
    },
    "validFrom": {
      "description": "Defines the date and time, when the issued credential becomes valid",
      "type": "string",
      "format": "date-time"
    },
    "validUntil": {
      "description": "Defines the date and time, when the issued credential expires",
      "type": "string",
      "format": "date-time"
    },
    "credentialSubject": {
      "description": "Defines information about the subject that is defined by the type chain",
      "type": "object",
      "properties": {
        "version": {
          "description": "Describes the version of the timestamp token.",
          "type": "number",
          "format": "integer"
        },
        "policy": {
          "description": "TSA policy id",
          "type": "string"
        },
        "messageImprint": {
          "description": "Multihash+Multibase value of the timestamped object",
          "type": "string"
        },
        "genTime": {
          "description": "genTime is the time at which the time-stamp token has been created by the TSA.  It is expressed as UTC time (Coordinated Universal Time) to reduce confusion with the local time zone use. GeneralizedTime syntax can include fraction-of-second details. MUST be ISO 8601 compliant",
          "type": "string",
          "format": "date-time"
        }
      },
      "accuracy": {
        "description": "Accuracy expressed in seconds, milliseconds, and/or microseconds. Property can be omitted if the accuracy is defined by the policy.",
        "type": "object",
        "properties": {
          "seconds": {
            "type": "number",
            "format": "integer"
          },
          "millis": {
            "description": "Range: 1..999",
            "type": "number",
            "format": "integer"
          },
          "micros": {
            "description": "Range: 1..999",
            "type": "number",
            "format": "integer"
          }
        }
      },
      "ordering": {
        "description": "If the ordering field is missing, or if the ordering field is present and set to false, then the genTime field only indicates the time at which the time-stamp token has been created by the TSA.  In such a case, the ordering of time-stamp tokens issued by the same TSA or different TSAs is only possible when the difference between the genTime of the first time-stamp token and the genTime of the second time-stamp token is greater than the sum of the accuracies of the genTime for each time-stamp token.",
        "type": "boolean"
      }
    },
    "credentialSchema": {
      "anyOf": [
        {
          "$ref": "#/$defs/credentialSchema"
        },
        {
          "type": "array",
          "items": {
            "$ref": "#/$defs/credentialSchema"
          }
        }
      ]
    },
    "termsOfUse": {
      "anyOf": [
        {
          "$ref": "#/$defs/termsOfUse"
        },
        {
          "type": "array",
          "items": {
            "$ref": "#/$defs/termsOfUse"
          }
        }
      ]
    }
  },
  "required": [
    "@context",
    "type",
    "issuer",
    "validFrom",
    "credentialSubject",
    "credentialSchema"
  ],
  "$defs": {
    "credentialSchema": {
      "description": "Contains information about the credential schema on which the issued credential is based",
      "type": "object",
      "properties": {
        "id": {
          "description": "References the credential schema stored on the Trusted Schemas Registry (TSR) on which the Verifiable Authorisation is based",
          "type": "string",
          "format": "uri"
        },
        "type": {
          "description": "Defines credential schema type",
          "type": "string",
          "enum": ["FullJsonSchemaValidator2021"]
        }
      },
      "required": ["id", "type"]
    },
    "termsOfUse": {
      "description": "Contains the terms under which the issued credential was issued",
      "type": "object",
      "properties": {
        "id": {
          "description": "Contains a URL that points to where more information about this instance of terms of use can be found.",
          "type": "string",
          "format": "uri"
        },
        "type": {
          "description": "Defines the type extension",
          "type": "string"
        }
      },
      "required": ["type"]
    }
  }
}
